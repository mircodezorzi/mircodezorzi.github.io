<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Reversing Packet Tracer | (&gt;&gt;=) :: mircodz</title>
  <meta name="description" content="CTF player with NoPwnIntended and mhackeroni.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Reversing Packet Tracer" />
<meta property="og:description" content="Reversing  Stage 1: decryptPTSave Stage 2: decipher Stage 3: deobfuscateBytes Stage 4: qUncompresss   Putting it All Together Patching  Bypassing Login   Forging  100%   Resources  Reversing Thankfully Cisco developers seem to have forgotten to strip the binary&rsquo;s symbols of the Linux version, so we are going to take advantage of it; this will help up tremendously in the reversing process and it will save us a huge amount of time as we won&rsquo;t have to locate the functions that were interested in." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mircodezorzi.github.io/posts/reversing-packet-tracer/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-27T00:00:00&#43;01:00" />
<meta property="article:modified_time" content="2021-05-20T13:09:25&#43;02:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Reversing Packet Tracer"/>
<meta name="twitter:description" content="Reversing  Stage 1: decryptPTSave Stage 2: decipher Stage 3: deobfuscateBytes Stage 4: qUncompresss   Putting it All Together Patching  Bypassing Login   Forging  100%   Resources  Reversing Thankfully Cisco developers seem to have forgotten to strip the binary&rsquo;s symbols of the Linux version, so we are going to take advantage of it; this will help up tremendously in the reversing process and it will save us a huge amount of time as we won&rsquo;t have to locate the functions that were interested in."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://mircodezorzi.github.io/css/style-white.css">
  
   <link rel="stylesheet" href="https://mircodezorzi.github.io/css/syntax.css"> 
  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://mircodezorzi.github.io/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">~/home</a></li>
         
        <li><a href="/posts">~/posts</a></li>
         
        <li><a href="/tags">~/tags</a></li>
         
        <li><a href="/about">~/about</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li>
          <a class="icon" href="https://mircodezorzi.github.io/about/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&text=Reversing%20Packet%20Tracer" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&title=Reversing%20Packet%20Tracer" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&is_video=false&description=Reversing%20Packet%20Tracer" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Reversing%20Packet%20Tracer&body=Check out this article: https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&title=Reversing%20Packet%20Tracer" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&title=Reversing%20Packet%20Tracer" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&name=Reversing%20Packet%20Tracer&description=Reversing%20%20Stage%201%3a%20decryptPTSave%20Stage%202%3a%20decipher%20Stage%203%3a%20deobfuscateBytes%20Stage%204%3a%20qUncompresss%20%20%20Putting%20it%20All%20Together%20Patching%20%20Bypassing%20Login%20%20%20Forging%20%20100%25%20%20%20Resources%20%20Reversing%20Thankfully%20Cisco%20developers%20seem%20to%20have%20forgotten%20to%20strip%20the%20binary%26rsquo%3bs%20symbols%20of%20the%20Linux%20version%2c%20so%20we%20are%20going%20to%20take%20advantage%20of%20it%3b%20this%20will%20help%20up%20tremendously%20in%20the%20reversing%20process%20and%20it%20will%20save%20us%20a%20huge%20amount%20of%20time%20as%20we%20won%26rsquo%3bt%20have%20to%20locate%20the%20functions%20that%20were%20interested%20in." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&t=Reversing%20Packet%20Tracer" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#reversing">Reversing</a>
      <ul>
        <li><a href="#stage-1-decryptptsave">Stage 1: decryptPTSave</a></li>
        <li><a href="#stage-2-decipher">Stage 2: decipher</a></li>
        <li><a href="#stage-3-deobfuscatebytes">Stage 3: deobfuscateBytes</a></li>
        <li><a href="#stage-4-quncompresss">Stage 4: qUncompresss</a></li>
      </ul>
    </li>
    <li><a href="#putting-it-all-together">Putting it All Together</a></li>
    <li><a href="#patching">Patching</a>
      <ul>
        <li><a href="#bypassing-login">Bypassing Login</a></li>
      </ul>
    </li>
    <li><a href="#forging">Forging</a>
      <ul>
        <li><a href="#100">100%</a></li>
      </ul>
    </li>
    <li><a href="#resources">Resources</a></li>
  </ul>
</nav>
    </div>
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Reversing Packet Tracer
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2020-11-27 00:00:00 &#43;0100 CET" itemprop="datePublished">2020-11-27</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          10 minute read
        </div>
        
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/reversing" rel="tag">reversing</a>
            
             ,  
            <a class="tag-link" href="/tags/packettracer" rel="tag">packettracer</a>
            
        </div>
        
      </div>
    </header>

  
    <div class="content" itemprop="articleBody">
      <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ul>
<li><a href="#reversing">Reversing</a>
<ul>
<li><a href="#stage-1-decryptptsave">Stage 1: decryptPTSave</a></li>
<li><a href="#stage-2-decipher">Stage 2: decipher</a></li>
<li><a href="#stage-3-deobfuscatebytes">Stage 3: deobfuscateBytes</a></li>
<li><a href="#stage-4-quncompresss">Stage 4: qUncompresss</a></li>
</ul>
</li>
<li><a href="#putting-it-all-together">Putting it All Together</a></li>
<li><a href="#patching">Patching</a>
<ul>
<li><a href="#bypassing-login">Bypassing Login</a></li>
</ul>
</li>
<li><a href="#forging">Forging</a>
<ul>
<li><a href="#100">100%</a></li>
</ul>
</li>
<li><a href="#resources">Resources</a></li>
</ul>
<!-- raw HTML omitted -->
<h2 id="reversing">Reversing</h2>
<p>Thankfully Cisco developers seem to have forgotten to strip the binary&rsquo;s symbols of the Linux version, so we are going to take advantage of it; this will help up tremendously in the reversing process and it will save us a huge amount of time as we won&rsquo;t have to locate the functions that were interested in. After opening up the binary in IDA and giving it some time to analyze it we can start looking for some interesting functions that might be useful to us. The one that stands out the most is <code>decryptFileBytes</code>; if we try to run Packet Tracer under a debugger and we add a breakpoint on said function, opening any <code>pka</code> or <code>pkt</code> file we immediately trigger the said breakepoint with the following backtrace:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">[#0] 0x5555589f9560 → Util::decryptFileBytes(QByteArray const&amp;, QByteArray&amp;, QString)()
[#1] 0x555558b7762f → CAppWindow::fileOpenFromBytes(QByteArray const&amp;, QString const&amp;)()
[#2] 0x555558b7b5eb → CAppWindow::fileOpen(QString)()
[#3] 0x555558b7b138 → CAppWindow::fileOpenFolder(QString const&amp;)()
[#4] 0x555558b4f646 → CAppWindow::fileOpen()()
[#5] 0x55555937a1f5 → CAppWindow::qt_static_metacall(QObject*, QMetaObject::Call, int, void**)()
[#6] 0x7fffeed0dd85 → QMetaObject::activate(QObject*, int, int, void**)()
[#7] 0x7ffff739f792 → QAction::triggered(bool)()
[#8] 0x7ffff73a1dac → QAction::activate(QAction::ActionEvent)()
[#9] 0x7ffff73a2701 → QAction::event(QEvent*)()
</code></pre></div><p>Looking at the decompiled pseudo-code generated by IDA we immediately find another three functions with interesting names: <code>decryptPTSave</code>, <code>deobfuscateBytes</code>, and <code>qUncompress</code>. Because the function uses <code>QDomDocument</code> we can also deduce that the simulation files are actually XML files decrypted and probably obfuscated.</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="n">Util</span><span class="o">::</span><span class="n">decryptFileBytes</span><span class="p">(</span><span class="k">const</span> <span class="n">QByteArray</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="n">QByteArray</span> <span class="o">*</span><span class="n">a2</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">QByteArray</span> <span class="o">*</span><span class="n">buf</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-50h] MAPDST
</span><span class="c1"></span>  <span class="n">QByteArray</span> <span class="n">plain</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-48h]
</span><span class="c1"></span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">a2</span><span class="p">;</span>
  <span class="n">v17</span> <span class="o">=</span> <span class="n">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
  <span class="n">QDomDocument</span><span class="o">::</span><span class="n">QDomDocument</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v12</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">QDomDocument</span><span class="o">::</span><span class="n">setContent</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v12</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">)</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">QByteArray</span><span class="o">::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">original</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">buf</span> <span class="o">=</span> <span class="n">QArrayData</span><span class="o">::</span><span class="n">shared_null</span><span class="p">;</span>
    <span class="n">Util</span><span class="o">::</span><span class="n">decryptPTSave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="n">input</span><span class="p">);</span> <span class="c1">// buf = decryptedPTSave(input)
</span><span class="c1"></span>    <span class="n">QByteArray</span><span class="o">::~</span><span class="n">QByteArray</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">QByteArray</span><span class="o">::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="n">input</span><span class="p">);</span>
    <span class="n">Util</span><span class="o">::</span><span class="n">deobfuscateBytes</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="n">input</span><span class="p">);</span> <span class="c1">// second parameter won&#39;t be used here
</span><span class="c1"></span>    <span class="n">v5</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">qUncompress</span><span class="p">(</span><span class="n">plain</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">var_50</span><span class="p">);</span>
    <span class="n">v6</span> <span class="o">=</span> <span class="o">*</span><span class="n">v2</span><span class="p">;</span>
    <span class="o">*</span><span class="n">v2</span> <span class="o">=</span> <span class="o">*</span><span class="n">plain</span><span class="p">;</span>
    <span class="o">*</span><span class="n">plain</span> <span class="o">=</span> <span class="n">v6</span><span class="p">;</span>
    <span class="n">QByteArray</span><span class="o">::~</span><span class="n">QByteArray</span><span class="p">(</span><span class="n">plain</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="p">(</span><span class="o">*</span><span class="n">v2</span> <span class="o">+</span> <span class="mi">4LL</span><span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// fail
</span><span class="c1"></span>    <span class="p">}</span>
    <span class="c1">// parse xml document
</span><span class="c1"></span><span class="p">}</span>
</code></pre></div><h3 id="stage-1-decryptptsave">Stage 1: decryptPTSave</h3>
<p>The first of he three functions of interest is <code>decryptPTSave</code> , an intermediary function which calls <code>Util::decrypt&lt;CryptoPP::Twofish&gt;</code>, forwarding it it&rsquo;s parameters together with 137 and 16, which we&rsquo;ll soon discover are the values of the key and initialization vectors.</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="n">_QWORD</span> <span class="o">*</span><span class="n">__fascall</span> <span class="n">Util</span><span class="o">::</span><span class="n">decryptPTSave</span><span class="p">(</span><span class="n">QByteArray</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="k">const</span> <span class="n">QByteArray</span> <span class="o">*</span><span class="n">a2</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">unsigned</span> <span class="n">__nt64</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// ST08_8
</span><span class="c1"></span>  <span class="n">_QWORD</span> <span class="o">*</span><span class="n">v1</span><span class="p">;</span><span class="c1">// rax
</span><span class="c1"></span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">__readsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
  <span class="n">v1</span> <span class="o">=</span> <span class="n">Util</span><span class="o">::</span><span class="n">ecrypt</span><span class="o">&lt;</span><span class="n">CryptoPP</span><span class="o">::</span><span class="n">Twofish</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="mi">137u</span><span class="p">,</span> <span class="mi">16u</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">__readsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">)</span> <span class="o">==</span> <span class="n">v2</span> <span class="p">)</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">a1</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">v1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>Analyzing <code>Utl::decrypt&lt;CryptoPP::Twofish&gt;</code> we find our first layer of obfuscation.</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="n">_QWORD</span> <span class="o">*</span><span class="n">__fascall</span> <span class="n">Util</span><span class="o">::</span><span class="n">decrypt</span><span class="o">&lt;</span><span class="n">CryptoPP</span><span class="o">::</span><span class="n">Twofish</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="kr">__int64</span> <span class="o">*</span><span class="n">a2</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">key_value</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">iv_value</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">unsigned</span> <span class="n">in</span> <span class="n">length</span><span class="p">;</span> <span class="c1">// ebx
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// ep
</span><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">offet</span><span class="p">;</span> <span class="c1">// rdx
</span><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">dat</span><span class="p">;</span> <span class="c1">// [rsp+10h] [rbp-78h] MAPDST
</span><span class="c1"></span>  <span class="kt">char</span> <span class="n">key</span><span class="p">;</span> <span class="o">/</span> <span class="p">[</span><span class="n">rsp</span><span class="o">+</span><span class="mi">20</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="n">rbp</span><span class="o">-</span><span class="mi">68</span><span class="n">h</span><span class="p">]</span>
  <span class="kt">char</span> <span class="n">iv</span><span class="p">;</span> <span class="c1">//[rsp+30h] [rbp-58h]
</span><span class="c1"></span>
  <span class="c1">// ...
</span><span class="c1"></span>
  <span class="n">v18</span> <span class="o">=</span> <span class="n">__reafsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
  <span class="nl">QByteArray</span><span class="p">:</span><span class="n">QByteArray</span><span class="p">(</span><span class="o">&amp;</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">v5</span> <span class="o">=</span> <span class="o">*</span><span class="n">a2</span><span class="p">;</span>
  <span class="n">length</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">length</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">do</span>
    <span class="p">{</span>
      <span class="n">v11</span> <span class="o">=</span> <span class="o">**</span><span class="p">(</span><span class="n">v5</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="n">v5</span> <span class="o">+</span> <span class="p">(</span><span class="n">length</span> <span class="o">+</span> <span class="o">~</span><span class="n">i</span><span class="p">))</span> <span class="o">^</span> <span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="n">i</span> <span class="o">*</span> <span class="n">length</span><span class="p">);</span> <span class="c1">// v11 = data[length - i - 1] ^ (length - i * length)
</span><span class="c1"></span>      <span class="c1">// Qt5 uffer size checks...
</span><span class="c1"></span>      <span class="n">offset</span>  <span class="o">*</span><span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="mi">16</span><span class="p">);</span>
      <span class="n">v10</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="p">;</span>
      <span class="o">*</span><span class="p">(</span><span class="n">offse</span> <span class="o">+</span> <span class="n">data</span> <span class="o">+</span> <span class="n">v10</span><span class="p">)</span> <span class="o">=</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// buf[i] = v11
</span><span class="c1"></span>      <span class="n">v5</span> <span class="o">=</span> <span class="o">*</span><span class="n">a</span><span class="p">;</span>
      <span class="n">length</span>  <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span> <span class="n">lngth</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="p">);</span>
  <span class="p">}</span>
  <span class="n">memset_s</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ky</span><span class="p">,</span> <span class="mi">16LL</span><span class="p">,</span> <span class="n">key_value</span><span class="p">,</span> <span class="mi">16LL</span><span class="p">);</span> <span class="c1">// 137
</span><span class="c1"></span>  <span class="n">memset_s</span><span class="p">(</span><span class="o">&amp;</span><span class="n">i</span><span class="p">,</span> <span class="mi">16LL</span><span class="p">,</span> <span class="n">iv_value</span><span class="p">,</span> <span class="mi">16LL</span><span class="p">);</span>   <span class="c1">// 16
</span><span class="c1"></span>  <span class="n">Util</span><span class="o">::</span><span class="n">deciper</span><span class="o">&lt;</span><span class="n">CryptoPP</span><span class="o">::</span><span class="n">Twofish</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v15</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">key</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">iv</span><span class="p">);</span>
  <span class="o">*</span><span class="n">a1</span> <span class="o">=</span> <span class="n">v15</span><span class="p">;</span>
  <span class="n">v15</span> <span class="o">=</span> <span class="n">QArraData</span><span class="o">::</span><span class="n">shared_null</span><span class="p">;</span>
  <span class="nl">QByteArray</span><span class="p">:</span><span class="o">~</span><span class="n">QByteArray</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v15</span><span class="p">);</span>
  <span class="nl">QByteArray</span><span class="p">:</span><span class="o">~</span><span class="n">QByteArray</span><span class="p">(</span><span class="o">&amp;</span><span class="n">data</span><span class="p">);</span>
  <span class="c1">// try-catc block ...
</span><span class="c1"></span>  <span class="k">return</span> <span class="n">v1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>We can rewrit the frist <code>do-while</code> loop in a neat <code>for</code> loop:</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">pocessed</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="sc">&#39;\0&#39;</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">processed</span><span class="p">[</span><span class="n">i</span> <span class="o">=</span> <span class="n">input</span><span class="p">[</span><span class="n">length</span> <span class="o">+</span> <span class="o">~</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="n">i</span> <span class="o">*</span> <span class="n">length</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><h3 id="stage-2-decipher">Stage 2: decipher</h3>
<p>Moving to <code>Utl::decipher</code>, we have finally reach the bottom of this rabbit hole. I won&rsquo;t bother to include the entire decompiled function as it is quite straightforward. It takes a <code>QByteArray</code>, a key, and an initialization vector; it decrypts the input using the <code>CryptoPP</code> library, returning a second <code>QByteArray</code> containing our decrypted input.</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="n">QByteArray</span> <span class="o">*</span><span class="n">_fastcall</span> <span class="n">Util</span><span class="o">::</span><span class="n">decipher</span><span class="o">&lt;</span><span class="n">CryptoPP</span><span class="o">::</span><span class="n">Twofish</span><span class="o">&gt;</span><span class="p">(</span><span class="n">QByteArray</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">,</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="n">iv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// ...
</span><span class="c1"></span>  <span class="n">CryptoPP</span><span class="o">::</span><span class="n">EX_Base</span><span class="o">::</span><span class="n">EAX_Base</span><span class="p">(</span><span class="o">&amp;</span><span class="n">decryptor</span><span class="p">);</span>
  <span class="c1">// ...
</span><span class="c1"></span>  <span class="n">CryptoPP</span><span class="o">::</span><span class="n">SmpleKeyingInterface</span><span class="o">::</span><span class="n">SetKeyWithIV</span><span class="p">(</span><span class="o">&amp;</span><span class="n">decryptor</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="mi">16uLL</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="mi">16uLL</span><span class="p">);</span>
  <span class="c1">// ...
</span><span class="c1"></span>  <span class="n">CryptoPP</span><span class="o">::</span><span class="n">AthenticatedDecryptionFilter</span><span class="o">::</span><span class="n">AuthenticatedDecryptionFilter</span><span class="p">(</span><span class="n">filter</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">decryptor</span><span class="p">,</span> <span class="n">sink</span><span class="p">,</span> <span class="mi">16LL</span><span class="p">,</span> <span class="mh">0xFFFFFFFFLL</span><span class="p">,</span> <span class="mi">5LL</span><span class="p">);</span>
  <span class="n">CryptoPP</span><span class="o">::</span><span class="n">SringSource</span><span class="o">::</span><span class="n">StringSource</span><span class="p">(</span><span class="o">&amp;</span><span class="n">stringsource</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">16LL</span><span class="p">)</span> <span class="o">+</span> <span class="o">*</span><span class="n">a2</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">4LL</span><span class="p">),</span> <span class="mi">1LL</span><span class="p">,</span> <span class="n">filter</span><span class="p">);</span>
  <span class="c1">// ...
</span><span class="c1"></span><span class="p">}</span>
</code></pre></div><h3 id="stage-3-deobfuscatebytes">Stage 3: deobfuscateBytes</h3>
<p>This second fnction iterates over the entire buffer and xors each byte with the size of the buffer relative it&rsquo;s position.</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="n">QByteArray</span> <span class="o">*</span><span class="n">_fastcall</span> <span class="n">Util</span><span class="o">::</span><span class="n">deobfuscateBytes</span><span class="p">(</span><span class="n">QByteArray</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="n">QByteArray</span> <span class="o">*</span><span class="n">unused</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">QByteArray</span> <span class="n">ptr</span><span class="p">;</span> <span class="c1">// rax
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">length</span><span class="p">;</span><span class="c1">// edx
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// ex
</span><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">offet</span><span class="p">;</span> <span class="c1">// rcx
</span><span class="c1"></span>  <span class="kt">char</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">//bp
</span><span class="c1"></span>
  <span class="n">ptr</span> <span class="o">=</span> <span class="o">*</span><span class="n">buf</span><span class="p">;</span>
  <span class="n">length</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="mi">4LL</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">length</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">do</span>
    <span class="p">{</span>
      <span class="n">v2</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
      <span class="n">offset</span>  <span class="o">*</span><span class="p">(</span><span class="n">ptr</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">// offset of the data relative to ptr
</span><span class="c1"></span>      <span class="n">v8</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">tr</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="n">i</span><span class="p">);</span> <span class="c1">// char v8 = buf[i] ^ sizeof(buf) - i
</span><span class="c1"></span>      <span class="c1">// Qt5 buffer size checks...
</span><span class="c1"></span>      <span class="o">++</span><span class="n">i</span><span class="p">;</span>
      <span class="o">*</span><span class="p">(</span><span class="n">v1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span> <span class="o">=</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// buf[i] = v8
</span><span class="c1"></span>      <span class="n">ptr</span> <span class="o">=</span> <span class="o">*</span><span class="n">uf</span><span class="p">;</span>
      <span class="n">length</span>  <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">buf</span> <span class="o">+</span> <span class="mi">4LL</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="p">(</span> <span class="n">lngth</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">ptr</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>Converting itinto a neater form in C++:</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">output</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span><span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">output</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="n">i</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><h3 id="stage-4-quncompresss">Stage 4: qUncompresss</h3>
<p>Lucky for us, the last step of the decoding function is quite trivial. <code>qUncompress</code> is a Qt5 function, and after a quick glance at the library&rsquo;s' documentation we discovered that it takes in a <code>QByteBuffer</code> and decompresses its contents using zlib. The only catch to it is that the first 4 bytes of the buffer must contain the size of the decompressed data, so we can write a small function to calculate the output size and discard the unneeded bytes.</p>
<h2 id="putting-it-all-together">Putting it All Together</h2>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="c1">/// \brief Reimplementation of qUncompress
</span><span class="c1"></span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">uncompress</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">len</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span>
                    <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>
                    <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span>  <span class="mi">8</span><span class="p">)</span>
                    <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>      <span class="p">);</span>

  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">&gt;</span> <span class="n">buf</span><span class="p">(</span><span class="n">len</span><span class="p">);</span>

  <span class="c1">// call zlibs&#39; uncompress
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="o">::</span><span class="n">uncompress</span><span class="p">(</span><span class="n">buf</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="o">&amp;</span><span class="n">len</span><span class="p">,</span> <span class="n">data</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">nbytes</span> <span class="o">-</span> <span class="mi">4</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">res</span> <span class="o">!=</span> <span class="n">Z_OK</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// handle error gracefully...
</span><span class="c1"></span>  <span class="p">}</span>

  <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="kt">char</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">buf</span><span class="p">.</span><span class="n">data</span><span class="p">()));</span>
<span class="p">}</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">decrypt</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">)</span>
  <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span> <span class="p">};</span>
  <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">iv</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span> <span class="p">};</span>

  <span class="k">typename</span> <span class="n">CryptoPP</span><span class="o">::</span><span class="n">EAX</span><span class="o">&lt;</span><span class="n">CryptoPP</span><span class="o">::</span><span class="n">TwoFish</span><span class="o">&gt;::</span><span class="n">Decryption</span> <span class="n">d</span><span class="p">;</span>
  <span class="n">d</span><span class="p">.</span><span class="n">SetKeyWithIV</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">iv</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">iv</span><span class="p">));</span>

  <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">input</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">processed</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="sc">&#39;\0&#39;</span><span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">output</span><span class="p">;</span>

  <span class="c1">// Stage 1 - deobfuscation
</span><span class="c1"></span>  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">processed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">input</span><span class="p">[</span><span class="n">length</span> <span class="o">+</span> <span class="o">~</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="n">i</span> <span class="o">*</span> <span class="n">length</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Stage 2 - decryption
</span><span class="c1"></span>  <span class="n">CryptoPP</span><span class="o">::</span><span class="n">StringSource</span> <span class="n">ss</span><span class="p">(</span><span class="n">processed</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span>
    <span class="k">new</span> <span class="n">CryptoPP</span><span class="o">::</span><span class="n">AuthenticatedDecryptionFilter</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="k">new</span> <span class="n">CryptoPP</span><span class="o">::</span><span class="n">StringSink</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
  <span class="p">);</span>

  <span class="c1">// Stage 3 - deobfuscation
</span><span class="c1"></span>  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">output</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">output</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="n">i</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Stage 4 - decompression
</span><span class="c1"></span>  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">decompressed</span> <span class="o">=</span> <span class="n">uncompress</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">output</span><span class="p">.</span><span class="n">data</span><span class="p">()),</span> <span class="n">output</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
  <span class="k">return</span> <span class="n">decompressed</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>And if we want to reverse the process:</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">compress</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">len</span> <span class="o">=</span> <span class="n">nbytes</span> <span class="o">+</span> <span class="n">nbytes</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">+</span> <span class="mi">13</span><span class="p">;</span>

  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">&gt;</span> <span class="n">buf</span><span class="p">(</span><span class="n">len</span><span class="p">);</span>

  <span class="n">buf</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">len</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>

  <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="o">::</span><span class="n">compress2</span><span class="p">(</span><span class="n">buf</span><span class="p">.</span><span class="n">data</span><span class="p">()</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">len</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">res</span> <span class="o">!=</span> <span class="n">Z_OK</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="n">res</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// need to shrink buffer to appropriate size after compression
</span><span class="c1"></span>  <span class="n">buf</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">len</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>

  <span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&amp;</span> <span class="mh">0xff000000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">;</span>
  <span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&amp;</span> <span class="mh">0x00ff0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">;</span>
  <span class="n">buf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&amp;</span> <span class="mh">0x0000ff00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">;</span>
  <span class="n">buf</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&amp;</span> <span class="mh">0x000000ff</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="kt">char</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">buf</span><span class="p">.</span><span class="n">data</span><span class="p">()),</span> <span class="n">buf</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">Algorithm</span><span class="o">&gt;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">encrypt</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">137</span> <span class="p">};</span>
  <span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">iv</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span> <span class="p">};</span>

  <span class="k">typename</span> <span class="n">CryptoPP</span><span class="o">::</span><span class="n">EAX</span><span class="o">&lt;</span><span class="n">CryptoPP</span><span class="o">::</span><span class="n">TwoFish</span><span class="o">&gt;::</span><span class="n">Encryption</span> <span class="n">e</span><span class="p">;</span>
  <span class="n">e</span><span class="p">.</span><span class="n">SetKeyWithIV</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">iv</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">iv</span><span class="p">));</span>

  <span class="c1">// Stage 1 - compression
</span><span class="c1"></span>  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">compressed</span> <span class="o">=</span> <span class="n">compress</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">data</span><span class="p">()),</span> <span class="n">input</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>

  <span class="c1">// Stage 2 - obfuscation
</span><span class="c1"></span>  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">compressed</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">compressed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">compressed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">compressed</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="n">i</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Stage 3 - encryption
</span><span class="c1"></span>  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">encrypted</span><span class="p">;</span>
  <span class="n">CryptoPP</span><span class="o">::</span><span class="n">StringSource</span> <span class="n">ss</span><span class="p">(</span><span class="n">compressed</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span>
    <span class="k">new</span> <span class="n">CryptoPP</span><span class="o">::</span><span class="n">AuthenticatedEncryptionFilter</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="k">new</span> <span class="n">CryptoPP</span><span class="o">::</span><span class="n">StringSink</span><span class="p">(</span><span class="n">encrypted</span><span class="p">))</span>
  <span class="p">);</span>

  <span class="c1">// Stage 4 - obfuscation
</span><span class="c1"></span>  <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">encrypted</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">output</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="sc">&#39;\0&#39;</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">encrypted</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">output</span><span class="p">[</span><span class="n">length</span> <span class="o">+</span> <span class="o">~</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">encrypted</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="n">i</span> <span class="o">*</span> <span class="n">length</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="n">output</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><h2 id="patching">Patching</h2>
<h3 id="bypassing-login">Bypassing Login</h3>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">1606495110527~K501UW~{a46d0802-d1d6-4341-adf4-3acacef612cb}~a0a1523a-a35b-41a7-b8ad-4cdc9f70e3f0~1615148676
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="n">v143</span> <span class="o">=</span> <span class="mi">2LL</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span> <span class="n">v218</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v218</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v143</span> <span class="o">=</span> <span class="mi">2LL</span><span class="p">,</span> <span class="o">!</span><span class="n">CAppWindow</span><span class="o">::</span><span class="n">IS_PTSA</span><span class="p">)</span> <span class="p">)</span>
<span class="p">{</span>
  <span class="n">QWidget</span><span class="o">::</span><span class="n">hide</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v284</span><span class="p">);</span>
  <span class="n">v180</span> <span class="o">=</span> <span class="p">(</span><span class="n">CNetspaceLogin</span> <span class="o">*</span><span class="p">)</span><span class="k">operator</span> <span class="k">new</span><span class="p">(</span><span class="mh">0x80uLL</span><span class="p">);</span>
  <span class="n">CNetspaceLogin</span><span class="o">::</span><span class="n">CNetspaceLogin</span><span class="p">(</span><span class="n">v180</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</code></pre></div><p>1500 lines prior</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="n">v40</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int64</span><span class="p">)</span><span class="n">isAuthenticated</span><span class="p">()</span> <span class="o">^</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="kr">__int64</span> <span class="nf">isAuthenticated</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// ...
</span><span class="c1"></span>
  <span class="n">v37</span> <span class="o">=</span> <span class="n">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
  <span class="n">QHostInfo</span><span class="o">::</span><span class="n">localHostName</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_hostname</span><span class="p">);</span>
  <span class="n">QCoreApplication</span><span class="o">::</span><span class="n">applicationFilePath</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">QFileInfo</span><span class="o">::</span><span class="n">QFileInfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v29</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">v0</span> <span class="o">=</span> <span class="n">v36</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">v36</span> <span class="o">||</span> <span class="o">*</span><span class="n">v36</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v1</span> <span class="o">=</span> <span class="n">_InterlockedSub</span><span class="p">(</span><span class="n">v36</span><span class="p">,</span> <span class="mi">1u</span><span class="p">),</span> <span class="n">v0</span> <span class="o">=</span> <span class="n">v36</span><span class="p">,</span> <span class="o">!</span><span class="n">v1</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">QArrayData</span><span class="o">::</span><span class="n">deallocate</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="mi">2LL</span><span class="p">,</span> <span class="mi">8LL</span><span class="p">);</span>
  <span class="n">QFileInfo</span><span class="o">::</span><span class="n">absolutePath</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">QFileInfo</span><span class="o">::</span><span class="n">QFileInfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v30</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">v36</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">v36</span> <span class="o">||</span> <span class="o">*</span><span class="n">v36</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v3</span> <span class="o">=</span> <span class="n">_InterlockedSub</span><span class="p">(</span><span class="n">v36</span><span class="p">,</span> <span class="mi">1u</span><span class="p">),</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">v36</span><span class="p">,</span> <span class="o">!</span><span class="n">v3</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">QArrayData</span><span class="o">::</span><span class="n">deallocate</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="mi">2LL</span><span class="p">,</span> <span class="mi">8LL</span><span class="p">);</span>
  <span class="n">QFileInfo</span><span class="o">::</span><span class="n">created</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">v24</span> <span class="o">=</span> <span class="n">QDateTime</span><span class="o">::</span><span class="n">toMSecsSinceEpoch</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">QDateTime</span><span class="o">::~</span><span class="n">QDateTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">getAuthenicationFilePath</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="n">QFile</span><span class="o">::</span><span class="n">QFile</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="n">v4</span> <span class="o">=</span> <span class="n">v60</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">v60</span> <span class="o">||</span> <span class="o">*</span><span class="n">v60</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v5</span> <span class="o">=</span> <span class="n">_InterlockedSub</span><span class="p">(</span><span class="n">v60</span><span class="p">,</span> <span class="mi">1u</span><span class="p">),</span> <span class="n">v4</span> <span class="o">=</span> <span class="n">v60</span><span class="p">,</span> <span class="o">!</span><span class="n">v5</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">QArrayData</span><span class="o">::</span><span class="n">deallocate</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span> <span class="mi">2LL</span><span class="p">,</span> <span class="mi">8LL</span><span class="p">);</span>
</code></pre></div><p>Inline strlen generated by Qt which fallsback to using standard strlen.</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="k">if</span> <span class="p">(</span> <span class="n">QFile</span><span class="o">::</span><span class="n">exists</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v6</span> <span class="o">=</span> <span class="n">QFile</span><span class="o">::</span><span class="n">open</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">,</span> <span class="mi">1LL</span><span class="p">),</span> <span class="n">v6</span><span class="p">)</span> <span class="p">)</span> <span class="c1">// open $HOME/packettracer/nets
</span><span class="c1"></span><span class="p">{</span>
  <span class="n">QIODevice</span><span class="o">::</span><span class="n">readAll</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="n">Util</span><span class="o">::</span><span class="n">decryptLog</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v31</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="n">QByteArray</span><span class="o">::~</span><span class="n">QByteArray</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">QByteArray</span><span class="o">::</span><span class="n">isNull</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v31</span><span class="p">)</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v34</span> <span class="o">=</span> <span class="n">QArrayData</span><span class="o">::</span><span class="n">shared_null</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">v31</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="n">v31</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v14</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">v31</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">v14</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="n">v15</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">data</span> <span class="p">)</span>
        <span class="p">{</span>
          <span class="k">do</span>
          <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">v14</span> <span class="o">==</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
              <span class="k">break</span><span class="p">;</span>
            <span class="o">++</span><span class="n">v15</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">while</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">v15</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">QString</span><span class="o">::</span><span class="n">fromUtf8_helper</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v34</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>   <span class="c1">// creates a qstring given a const char* and length
</span><span class="c1"></span>  <span class="p">}</span>
</code></pre></div><p>After reading /nets file, split the string and check each element</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="n">v60</span> <span class="o">=</span> <span class="n">QString</span><span class="o">::</span><span class="n">fromAscii_helper</span><span class="p">(</span><span class="s">&#34;~&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v11</span><span class="p">);</span>
<span class="n">QString</span><span class="o">::</span><span class="n">split</span><span class="p">(</span><span class="n">v32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v34</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">1LL</span><span class="p">);</span>  <span class="c1">// v32 is a QStringList
</span><span class="c1"></span><span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
<span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v34</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">12LL</span><span class="p">)</span> <span class="o">-</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="p">)</span>   <span class="c1">// v32 + 12 and v32 + 8 must be the pointers to the beginig and end?
</span><span class="c1"></span><span class="p">{</span>                                           <span class="c1">// check for length &gt; 2?
</span><span class="c1"></span>  <span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;::</span><span class="n">detach</span><span class="p">(</span><span class="n">v32</span><span class="p">);</span>
  <span class="n">v70</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span> <span class="o">*</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">40</span><span class="p">);</span> <span class="c1">// (40 - 16) / 8 = 3
</span><span class="c1"></span>  <span class="n">QtPrivate</span><span class="o">::</span><span class="n">RefCount</span><span class="o">::</span><span class="n">ref</span><span class="p">(</span><span class="n">v70</span><span class="p">);</span>            <span class="c1">// tracking id
</span><span class="c1"></span>  <span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;::</span><span class="n">detach</span><span class="p">(</span><span class="n">v32</span><span class="p">);</span>
  <span class="n">v60</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span> <span class="o">*</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">16</span><span class="p">);</span> <span class="c1">// + 16 = first
</span><span class="c1"></span>  <span class="n">QtPrivate</span><span class="o">::</span><span class="n">RefCount</span><span class="o">::</span><span class="n">ref</span><span class="p">(</span><span class="n">v60</span><span class="p">);</span>
  <span class="n">v27</span> <span class="o">=</span> <span class="n">QString</span><span class="o">::</span><span class="n">toLongLong</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
  <span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="n">v16</span> <span class="o">=</span> <span class="n">v32</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">12LL</span><span class="p">)</span> <span class="o">-</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;::</span><span class="n">detach</span><span class="p">(</span><span class="n">v32</span><span class="p">);</span>
    <span class="n">v34</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span> <span class="o">*</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">48</span><span class="p">);</span> <span class="c1">// + 48 = fifth
</span><span class="c1"></span>    <span class="n">QtPrivate</span><span class="o">::</span><span class="n">RefCount</span><span class="o">::</span><span class="n">ref</span><span class="p">(</span><span class="n">v34</span><span class="p">);</span>
    <span class="n">v21</span> <span class="o">=</span> <span class="n">QString</span><span class="o">::</span><span class="n">toLongLong</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v34</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
    <span class="n">QDateTime</span><span class="o">::</span><span class="n">currentDateTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
    <span class="n">v26</span> <span class="o">=</span> <span class="n">v21</span> <span class="o">-</span> <span class="n">QDateTime</span><span class="o">::</span><span class="n">toSecsSinceEpoch</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span> <span class="c1">// check expiry against current date
</span><span class="c1"></span>    <span class="n">QDateTime</span><span class="o">::~</span><span class="n">QDateTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
    <span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v34</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">v26</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">v60</span> <span class="o">=</span> <span class="n">QString</span><span class="o">::</span><span class="n">fromAscii_helper</span><span class="p">(</span><span class="o">&amp;</span><span class="n">src</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="n">v16</span><span class="p">);</span>
  <span class="n">v17</span> <span class="o">=</span> <span class="n">COptions</span><span class="o">::</span><span class="n">getMainOptions</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
  <span class="n">v18</span> <span class="o">=</span> <span class="n">getLogonTimeString</span><span class="p">();</span>               <span class="c1">// runs whoami &amp; last
</span><span class="c1"></span>  <span class="n">nets_hostname</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">;</span>
  <span class="n">v25</span> <span class="o">=</span> <span class="n">COptions</span><span class="o">::</span><span class="n">isLoginTimeMatch</span><span class="p">(</span><span class="n">v17</span><span class="p">,</span> <span class="n">v18</span><span class="p">);</span>
  <span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v24</span> <span class="o">==</span> <span class="n">v27</span>
    <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;::</span><span class="n">detach</span><span class="p">(</span><span class="n">v32</span><span class="p">),</span>
        <span class="n">nets_hostname</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span> <span class="o">*</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">24</span><span class="p">),</span> <span class="c1">// + 24 = second
</span><span class="c1"></span>        <span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="n">nets_hostname</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">local_hostname</span><span class="p">))</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">Util</span><span class="o">::</span><span class="n">getAppInstallIdString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span> <span class="c1">// installation id != tracking id
</span><span class="c1"></span>    <span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;::</span><span class="n">detach</span><span class="p">(</span><span class="n">v32</span><span class="p">);</span>
    <span class="n">nets_hostname</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">;</span>
    <span class="n">v22</span> <span class="o">=</span> <span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span> <span class="o">*</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span> <span class="c1">// + 32 = third
</span><span class="c1"></span>    <span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
    <span class="n">v20</span> <span class="o">=</span> <span class="n">v22</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">1606495110527~K501UW~{a46d0802-d1d6-4341-adf4-3acacef612cb}~a0a1523a-a35b-41a7-b8ad-4cdc9f70e3f0~1615148676
|             |       |                                     |                                    |
last login    |       |                                     |                                    |
              hostname|                                     |                                    |
                      installation id                       |                                    |
                                                            tracking id                          |
                                                                                                 expiry date
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++">      <span class="k">else</span>
      <span class="p">{</span>
        <span class="n">v20</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">LOBYTE</span><span class="p">(</span><span class="n">v20</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">v26</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="n">v20</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">v20</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">v70</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">v26</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">v25</span> <span class="p">)</span>
        <span class="p">{</span>
          <span class="n">v23</span> <span class="o">=</span> <span class="n">CAnalyticsTracker</span><span class="o">::</span><span class="n">getInstance</span><span class="p">(</span><span class="n">nets_hostname</span><span class="p">);</span>
          <span class="n">v60</span> <span class="o">=</span> <span class="n">v70</span><span class="p">;</span>
          <span class="n">QtPrivate</span><span class="o">::</span><span class="n">RefCount</span><span class="o">::</span><span class="n">ref</span><span class="p">(</span><span class="n">v70</span><span class="p">);</span>
          <span class="n">CAnalyticsTracker</span><span class="o">::</span><span class="n">setUsername</span><span class="p">(</span><span class="n">v23</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
          <span class="n">v6</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
          <span class="n">v6</span> <span class="o">=</span> <span class="n">v20</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v70</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">QFileDevice</span><span class="o">::</span><span class="n">close</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
    <span class="n">v7</span> <span class="o">=</span> <span class="n">v6</span> <span class="o">^</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;::~</span><span class="n">QList</span><span class="p">(</span><span class="n">v32</span><span class="p">);</span>
    <span class="n">QByteArray</span><span class="o">::~</span><span class="n">QByteArray</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v31</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>                                          <span class="c1">// if ( *(*v32 + 12LL) - *(*v32 + 8LL) &gt; 2 )
</span><span class="c1"></span>  <span class="p">{</span>
    <span class="n">v7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">QFile</span><span class="o">::~</span><span class="n">QFile</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">QFileInfo</span><span class="o">::~</span><span class="n">QFileInfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v30</span><span class="p">);</span>
  <span class="n">QFileInfo</span><span class="o">::~</span><span class="n">QFileInfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v29</span><span class="p">);</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="n">local_hostname</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">local_hostname</span> <span class="o">||</span> <span class="o">*</span><span class="n">local_hostname</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v9</span> <span class="o">=</span> <span class="n">_InterlockedSub</span><span class="p">(</span><span class="n">local_hostname</span><span class="p">,</span> <span class="mi">1u</span><span class="p">),</span> <span class="n">v8</span> <span class="o">=</span> <span class="n">local_hostname</span><span class="p">,</span> <span class="o">!</span><span class="n">v9</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">QArrayData</span><span class="o">::</span><span class="n">deallocate</span><span class="p">(</span><span class="n">v8</span><span class="p">,</span> <span class="mi">2LL</span><span class="p">,</span> <span class="mi">8LL</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">v7</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><h2 id="forging">Forging</h2>
<p>It works!</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">foobar~foobar~foobar~foobar~1615148676
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">60 * 60 * 24 * 30 * 3 = 7,776,000 ~ 1615148676 - (1606495110527 / 1000)
</code></pre></div><h3 id="100">100%</h3>
<pre><code class="language-x86asm" data-lang="x86asm">.text:0000000000DFF5C0 ; Activity::CTreeNode::setCheck(bool)
.text:0000000000DFF5C0                 public _ZN8Activity9CTreeNode8setCheckEb
.text:0000000000DFF5C0 _ZN8Activity9CTreeNode8setCheckEb:      ; CODE XREF: Activity::CShapeTest::checkComparatorTree(Activity::CTreeNode *,Activity::CComparable *)+2907↑p
.text:0000000000DFF5C0                                         ; Activity::CShapeTest::checkComparatorTree(Activity::CTreeNode *,Activity::CComparable *)+2AFA↑p ...
.text:0000000000DFF5C0 ; __unwind {
.text:0000000000DFF5C0                 mov     esi, 2
.text:0000000000DFF5C5                 jmp     near ptr _ZN8Activity9CTreeNode12setCheckTypeENS_10ECheckTypeE+1 ; Activity::CTreeNode::setCheckType(Activity::ECheckType)
.text:0000000000DFF5C5 ; ---------------------------------------------------------------------------
.text:0000000000DFF5CA                 db 0FFh
.text:0000000000DFF5CB                 db 0FFh
.text:0000000000DFF5CC                 db  0Fh
.text:0000000000DFF5CD                 db  1Fh
.text:0000000000DFF5CE                 db  40h ; @
.text:0000000000DFF5CF                 db    0
.text:0000000000DFF5D0 ; ---------------------------------------------------------------------------
.text:0000000000DFF5D0                 mov     esi, 2
.text:0000000000DFF5D5                 jmp     _ZN8Activity9CTreeNode12setCheckTypeENS_10ECheckTypeE ; Activity::CTreeNode::setCheckType(Activity::ECheckType)
.text:0000000000DFF5D5 ; } // starts at DFF5C0
.text:0000000000DFF5DA ; ---------------------------------------------------------------------------
.text:0000000000DFF5DA                 nop     word ptr [rax+rax+00h]
.text:0000000000DFF5E0
</code></pre><h2 id="resources">Resources</h2>
<ul>
<li><a href="https://github.com/mircodezorzi/pka2xml/blob/master/reversing/decompiled/decipher.cpp">decipher.cpp</a></li>
<li><a href="https://github.com/mircodezorzi/pka2xml/blob/master/reversing/decompiled/decrypt.cpp">decrypt.cpp</a></li>
<li><a href="https://github.com/mircodezorzi/pka2xml/blob/master/reversing/decompiled/decryptFileBytes.cpp">decryptFileBytes.cpp</a></li>
<li><a href="https://github.com/mircodezorzi/pka2xml/blob/master/reversing/decompiled/deobfuscateBytes.cpp">deobfuscateBytes.cpp</a></li>
</ul>

    </div>
  </article>

  
  





  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">~/home</a></li>
         
          <li><a href="/posts">~/posts</a></li>
         
          <li><a href="/tags">~/tags</a></li>
         
          <li><a href="/about">~/about</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#reversing">Reversing</a>
      <ul>
        <li><a href="#stage-1-decryptptsave">Stage 1: decryptPTSave</a></li>
        <li><a href="#stage-2-decipher">Stage 2: decipher</a></li>
        <li><a href="#stage-3-deobfuscatebytes">Stage 3: deobfuscateBytes</a></li>
        <li><a href="#stage-4-quncompresss">Stage 4: qUncompresss</a></li>
      </ul>
    </li>
    <li><a href="#putting-it-all-together">Putting it All Together</a></li>
    <li><a href="#patching">Patching</a>
      <ul>
        <li><a href="#bypassing-login">Bypassing Login</a></li>
      </ul>
    </li>
    <li><a href="#forging">Forging</a>
      <ul>
        <li><a href="#100">100%</a></li>
      </ul>
    </li>
    <li><a href="#resources">Resources</a></li>
  </ul>
</nav>
    </div>

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&text=Reversing%20Packet%20Tracer" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&title=Reversing%20Packet%20Tracer" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&is_video=false&description=Reversing%20Packet%20Tracer" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Reversing%20Packet%20Tracer&body=Check out this article: https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&title=Reversing%20Packet%20Tracer" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&title=Reversing%20Packet%20Tracer" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&name=Reversing%20Packet%20Tracer&description=Reversing%20%20Stage%201%3a%20decryptPTSave%20Stage%202%3a%20decipher%20Stage%203%3a%20deobfuscateBytes%20Stage%204%3a%20qUncompresss%20%20%20Putting%20it%20All%20Together%20Patching%20%20Bypassing%20Login%20%20%20Forging%20%20100%25%20%20%20Resources%20%20Reversing%20Thankfully%20Cisco%20developers%20seem%20to%20have%20forgotten%20to%20strip%20the%20binary%26rsquo%3bs%20symbols%20of%20the%20Linux%20version%2c%20so%20we%20are%20going%20to%20take%20advantage%20of%20it%3b%20this%20will%20help%20up%20tremendously%20in%20the%20reversing%20process%20and%20it%20will%20save%20us%20a%20huge%20amount%20of%20time%20as%20we%20won%26rsquo%3bt%20have%20to%20locate%20the%20functions%20that%20were%20interested%20in." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fmircodezorzi.github.io%2fposts%2freversing-packet-tracer%2f&t=Reversing%20Packet%20Tracer" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2021  (&gt;&gt;=) :: mircodz 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">~/home</a></li>
         
        <li><a href="/posts">~/posts</a></li>
         
        <li><a href="/tags">~/tags</a></li>
         
        <li><a href="/about">~/about</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>



</html>
