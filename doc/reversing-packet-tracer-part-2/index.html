<!DOCTYPE html>
<html><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Reversing Packet Tracer Part 2: Shenanigans - (&gt;&gt;=) :: mircodz</title><meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="description" content="" />

  <script src="https://mircodezorzi.github.io/js/main.js"></script>

  <link rel="preconnect" href="//fonts.gstatic.com">
  <link href="//fonts.googleapis.com/css2?family=Work+Sans&display=swap" rel="stylesheet">
  <link href="//fonts.googleapis.com/css2?family=IBM+Plex+Mono&display=swap" rel="stylesheet">

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/styles/github.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/languages/x86asm.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/languages/cmake.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/languages/lisp.min.js"></script>
  <script charset="utf-8">
    hljs.registerLanguage("emacs-lisp", hljs.getLanguage("lisp").rawDefinition);
  </script>
  <script>hljs.initHighlightingOnLoad();</script>

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-172736282-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


  <link rel="stylesheet" type="text/css" media="screen" href="https://mircodezorzi.github.io/css/main.css" />
  
</head>
<body>
        <div class="content"><header>
  <div class="main">
    <a href="https://mircodezorzi.github.io/">(&gt;&gt;=) :: mircodz</a>
  </div>
  <nav>
    
      <a href="/tags/">tags</a>
    
  </nav>
</header>

<main>
  <article>
    <div class="title">
      <h1 class="title">Reversing Packet Tracer Part 2: Shenanigans</h1>
      <div class="meta date-posted">Posted on Dec 5, 2020
      
        <div class="meta date-updated">(Updated on Feb 14, 2021)</div>
      
      </div>
    </div>

    <div class="post-tags">
      
      
      <nav class="nav tags">
        <ul class="tags">
          
          <li><a href="/tags/reversing">reversing</a></li>
          
          <li><a href="/tags/packettracer">packettracer</a></li>
          
        </ul>
      </nav>
      
      
    </div>

    
      
        <div class="hugotoc no-text-decoration">
          <nav id="TableOfContents">
  <ul>
    <li><a href="#bypassing-login">Bypassing Login</a></li>
    <li><a href="#100">100%</a></li>
  </ul>
</nav>
          <a href="#" class="back-to-top">Back to top</a>
        </div>
      
      <script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script type="application/javascript">(function() {
     var $window = $(window);
     if ($window.width() >= 1400) { 
         var $toc = $('#TableOfContents');
         if ($toc.length > 0) {
             function onScroll(){
                 var currentScroll = $window.scrollTop();
                 var h = $('[id^="headline"]');
                 var id = "";
                 h.each(function (i, e) {
                     e = $(e);
                     if (e.offset().top - 10 <= currentScroll) {
                         id = e.attr('id');
                     }
                 });
                 var current = $toc.find('a.current');
                 if (current.length == 1 && current.eq(0).attr('href') == '#' + id) return true;

                 current.each(function (i, e) {
                     $(e).removeClass('current').siblings('ul').hide();
                 });
                 $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
                     $(e).children('a').addClass('current').siblings('ul').show();
                 });
             }
             $window.on('scroll', onScroll);
             $(document).ready(function() {
                 $toc.find('a').parent('li').find('ul').hide();
                 onScroll();
                 document.getElementsByClassName('hugotoc')[0].style.display = '';
             });}}})();</script>

    

    <section class="body">
      <div class="ox-hugo-toc toc">
<div></div>
<div class="heading">Table of Contents</div>
<ul>
<li><a href="#bypassing-login">Bypassing Login</a></li>
<li><a href="#100">100%</a></li>
</ul>
</div>
<!--endtoc-->
<h2 id="bypassing-login">Bypassing Login</h2>
<p>TODO everything</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">1606495110527~K501UW~{a46d0802-d1d6-4341-adf4-3acacef612cb}~a0a1523a-a35b-41a7-b8ad-4cdc9f70e3f0~1615148676
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="n">v143</span> <span class="o">=</span> <span class="mi">2LL</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span> <span class="n">v218</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v218</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v143</span> <span class="o">=</span> <span class="mi">2LL</span><span class="p">,</span> <span class="o">!</span><span class="n">CAppWindow</span><span class="o">::</span><span class="n">IS_PTSA</span><span class="p">)</span> <span class="p">)</span>
<span class="p">{</span>
  <span class="n">QWidget</span><span class="o">::</span><span class="n">hide</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v284</span><span class="p">);</span>
  <span class="n">v180</span> <span class="o">=</span> <span class="p">(</span><span class="n">CNetspaceLogin</span> <span class="o">*</span><span class="p">)</span><span class="k">operator</span> <span class="k">new</span><span class="p">(</span><span class="mh">0x80uLL</span><span class="p">);</span>
  <span class="n">CNetspaceLogin</span><span class="o">::</span><span class="n">CNetspaceLogin</span><span class="p">(</span><span class="n">v180</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</code></pre></div><p>1500 lines prior</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="n">v40</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int64</span><span class="p">)</span><span class="n">isAuthenticated</span><span class="p">()</span> <span class="o">^</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="kr">__int64</span> <span class="nf">isAuthenticated</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// ...
</span><span class="c1"></span>
  <span class="n">v37</span> <span class="o">=</span> <span class="n">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
  <span class="n">QHostInfo</span><span class="o">::</span><span class="n">localHostName</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_hostname</span><span class="p">);</span>
  <span class="n">QCoreApplication</span><span class="o">::</span><span class="n">applicationFilePath</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">QFileInfo</span><span class="o">::</span><span class="n">QFileInfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v29</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">v0</span> <span class="o">=</span> <span class="n">v36</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">v36</span> <span class="o">||</span> <span class="o">*</span><span class="n">v36</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v1</span> <span class="o">=</span> <span class="n">_InterlockedSub</span><span class="p">(</span><span class="n">v36</span><span class="p">,</span> <span class="mi">1u</span><span class="p">),</span> <span class="n">v0</span> <span class="o">=</span> <span class="n">v36</span><span class="p">,</span> <span class="o">!</span><span class="n">v1</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">QArrayData</span><span class="o">::</span><span class="n">deallocate</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="mi">2LL</span><span class="p">,</span> <span class="mi">8LL</span><span class="p">);</span>
  <span class="n">QFileInfo</span><span class="o">::</span><span class="n">absolutePath</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">QFileInfo</span><span class="o">::</span><span class="n">QFileInfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v30</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">v2</span> <span class="o">=</span> <span class="n">v36</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">v36</span> <span class="o">||</span> <span class="o">*</span><span class="n">v36</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v3</span> <span class="o">=</span> <span class="n">_InterlockedSub</span><span class="p">(</span><span class="n">v36</span><span class="p">,</span> <span class="mi">1u</span><span class="p">),</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">v36</span><span class="p">,</span> <span class="o">!</span><span class="n">v3</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">QArrayData</span><span class="o">::</span><span class="n">deallocate</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="mi">2LL</span><span class="p">,</span> <span class="mi">8LL</span><span class="p">);</span>
  <span class="n">QFileInfo</span><span class="o">::</span><span class="n">created</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">v24</span> <span class="o">=</span> <span class="n">QDateTime</span><span class="o">::</span><span class="n">toMSecsSinceEpoch</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">QDateTime</span><span class="o">::~</span><span class="n">QDateTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">getAuthenicationFilePath</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="n">QFile</span><span class="o">::</span><span class="n">QFile</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="n">v4</span> <span class="o">=</span> <span class="n">v60</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">v60</span> <span class="o">||</span> <span class="o">*</span><span class="n">v60</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v5</span> <span class="o">=</span> <span class="n">_InterlockedSub</span><span class="p">(</span><span class="n">v60</span><span class="p">,</span> <span class="mi">1u</span><span class="p">),</span> <span class="n">v4</span> <span class="o">=</span> <span class="n">v60</span><span class="p">,</span> <span class="o">!</span><span class="n">v5</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">QArrayData</span><span class="o">::</span><span class="n">deallocate</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span> <span class="mi">2LL</span><span class="p">,</span> <span class="mi">8LL</span><span class="p">);</span>
</code></pre></div><p>Inline strlen generated by Qt which fallsback to using standard strlen.</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="k">if</span> <span class="p">(</span> <span class="n">QFile</span><span class="o">::</span><span class="n">exists</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v6</span> <span class="o">=</span> <span class="n">QFile</span><span class="o">::</span><span class="n">open</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">,</span> <span class="mi">1LL</span><span class="p">),</span> <span class="n">v6</span><span class="p">)</span> <span class="p">)</span> <span class="c1">// open $HOME/packettracer/nets
</span><span class="c1"></span><span class="p">{</span>
  <span class="n">QIODevice</span><span class="o">::</span><span class="n">readAll</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="n">Util</span><span class="o">::</span><span class="n">decryptLog</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v31</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="n">QByteArray</span><span class="o">::~</span><span class="n">QByteArray</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">QByteArray</span><span class="o">::</span><span class="n">isNull</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v31</span><span class="p">)</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v34</span> <span class="o">=</span> <span class="n">QArrayData</span><span class="o">::</span><span class="n">shared_null</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">v31</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="n">v31</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="n">v14</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">v31</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">v14</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="n">v15</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">data</span> <span class="p">)</span>
        <span class="p">{</span>
          <span class="k">do</span>
          <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">v14</span> <span class="o">==</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
              <span class="k">break</span><span class="p">;</span>
            <span class="o">++</span><span class="n">v15</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="k">while</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">v15</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span> <span class="n">i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">QString</span><span class="o">::</span><span class="n">fromUtf8_helper</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v34</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>   <span class="c1">// creates a qstring given a const char* and length
</span><span class="c1"></span>  <span class="p">}</span>
</code></pre></div><p>After reading /nets file, split the string and check each element</p>
<div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="n">v60</span> <span class="o">=</span> <span class="n">QString</span><span class="o">::</span><span class="n">fromAscii_helper</span><span class="p">(</span><span class="s">&#34;~&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v11</span><span class="p">);</span>
<span class="n">QString</span><span class="o">::</span><span class="n">split</span><span class="p">(</span><span class="n">v32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v34</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">1LL</span><span class="p">);</span>  <span class="c1">// v32 is a QStringList
</span><span class="c1"></span><span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
<span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v34</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">12LL</span><span class="p">)</span> <span class="o">-</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="p">)</span>   <span class="c1">// v32 + 12 and v32 + 8 must be the pointers to the beginig and end?
</span><span class="c1"></span><span class="p">{</span>                                           <span class="c1">// check for length &gt; 2?
</span><span class="c1"></span>  <span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;::</span><span class="n">detach</span><span class="p">(</span><span class="n">v32</span><span class="p">);</span>
  <span class="n">v70</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span> <span class="o">*</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">40</span><span class="p">);</span> <span class="c1">// (40 - 16) / 8 = 3
</span><span class="c1"></span>  <span class="n">QtPrivate</span><span class="o">::</span><span class="n">RefCount</span><span class="o">::</span><span class="n">ref</span><span class="p">(</span><span class="n">v70</span><span class="p">);</span>            <span class="c1">// tracking id
</span><span class="c1"></span>  <span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;::</span><span class="n">detach</span><span class="p">(</span><span class="n">v32</span><span class="p">);</span>
  <span class="n">v60</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span> <span class="o">*</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">16</span><span class="p">);</span> <span class="c1">// + 16 = first
</span><span class="c1"></span>  <span class="n">QtPrivate</span><span class="o">::</span><span class="n">RefCount</span><span class="o">::</span><span class="n">ref</span><span class="p">(</span><span class="n">v60</span><span class="p">);</span>
  <span class="n">v27</span> <span class="o">=</span> <span class="n">QString</span><span class="o">::</span><span class="n">toLongLong</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
  <span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="n">v16</span> <span class="o">=</span> <span class="n">v32</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">12LL</span><span class="p">)</span> <span class="o">-</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;::</span><span class="n">detach</span><span class="p">(</span><span class="n">v32</span><span class="p">);</span>
    <span class="n">v34</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span> <span class="o">*</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">48</span><span class="p">);</span> <span class="c1">// + 48 = fifth
</span><span class="c1"></span>    <span class="n">QtPrivate</span><span class="o">::</span><span class="n">RefCount</span><span class="o">::</span><span class="n">ref</span><span class="p">(</span><span class="n">v34</span><span class="p">);</span>
    <span class="n">v21</span> <span class="o">=</span> <span class="n">QString</span><span class="o">::</span><span class="n">toLongLong</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v34</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
    <span class="n">QDateTime</span><span class="o">::</span><span class="n">currentDateTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
    <span class="n">v26</span> <span class="o">=</span> <span class="n">v21</span> <span class="o">-</span> <span class="n">QDateTime</span><span class="o">::</span><span class="n">toSecsSinceEpoch</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span> <span class="c1">// check expiry against current date
</span><span class="c1"></span>    <span class="n">QDateTime</span><span class="o">::~</span><span class="n">QDateTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
    <span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v34</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">v26</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">v60</span> <span class="o">=</span> <span class="n">QString</span><span class="o">::</span><span class="n">fromAscii_helper</span><span class="p">(</span><span class="o">&amp;</span><span class="n">src</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="n">v16</span><span class="p">);</span>
  <span class="n">v17</span> <span class="o">=</span> <span class="n">COptions</span><span class="o">::</span><span class="n">getMainOptions</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
  <span class="n">v18</span> <span class="o">=</span> <span class="n">getLogonTimeString</span><span class="p">();</span>               <span class="c1">// runs whoami &amp; last
</span><span class="c1"></span>  <span class="n">nets_hostname</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">;</span>
  <span class="n">v25</span> <span class="o">=</span> <span class="n">COptions</span><span class="o">::</span><span class="n">isLoginTimeMatch</span><span class="p">(</span><span class="n">v17</span><span class="p">,</span> <span class="n">v18</span><span class="p">);</span>
  <span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v24</span> <span class="o">==</span> <span class="n">v27</span>
    <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;::</span><span class="n">detach</span><span class="p">(</span><span class="n">v32</span><span class="p">),</span>
        <span class="n">nets_hostname</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span> <span class="o">*</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">24</span><span class="p">),</span> <span class="c1">// + 24 = second
</span><span class="c1"></span>        <span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="n">nets_hostname</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">local_hostname</span><span class="p">))</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">Util</span><span class="o">::</span><span class="n">getAppInstallIdString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span> <span class="c1">// installation id != tracking id
</span><span class="c1"></span>    <span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;::</span><span class="n">detach</span><span class="p">(</span><span class="n">v32</span><span class="p">);</span>
    <span class="n">nets_hostname</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">;</span>
    <span class="n">v22</span> <span class="o">=</span> <span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span> <span class="o">*</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">v32</span> <span class="o">+</span> <span class="mi">8LL</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span> <span class="c1">// + 32 = third
</span><span class="c1"></span>    <span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
    <span class="n">v20</span> <span class="o">=</span> <span class="n">v22</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">1606495110527~K501UW~{a46d0802-d1d6-4341-adf4-3acacef612cb}~a0a1523a-a35b-41a7-b8ad-4cdc9f70e3f0~1615148676
|             |       |                                     |                                    |
last login    |       |                                     |                                    |
              hostname|                                     |                                    |
                      installation id                       |                                    |
                                                            tracking id                          |
                                                                                                 expiry date
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++">      <span class="k">else</span>
      <span class="p">{</span>
        <span class="n">v20</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="n">LOBYTE</span><span class="p">(</span><span class="n">v20</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">v26</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="n">v20</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span> <span class="n">v20</span> <span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">v70</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">v26</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">v25</span> <span class="p">)</span>
        <span class="p">{</span>
          <span class="n">v23</span> <span class="o">=</span> <span class="n">CAnalyticsTracker</span><span class="o">::</span><span class="n">getInstance</span><span class="p">(</span><span class="n">nets_hostname</span><span class="p">);</span>
          <span class="n">v60</span> <span class="o">=</span> <span class="n">v70</span><span class="p">;</span>
          <span class="n">QtPrivate</span><span class="o">::</span><span class="n">RefCount</span><span class="o">::</span><span class="n">ref</span><span class="p">(</span><span class="n">v70</span><span class="p">);</span>
          <span class="n">CAnalyticsTracker</span><span class="o">::</span><span class="n">setUsername</span><span class="p">(</span><span class="n">v23</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
          <span class="n">v6</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v60</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
          <span class="n">v6</span> <span class="o">=</span> <span class="n">v20</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="n">QString</span><span class="o">::~</span><span class="n">QString</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v70</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">QFileDevice</span><span class="o">::</span><span class="n">close</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
    <span class="n">v7</span> <span class="o">=</span> <span class="n">v6</span> <span class="o">^</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">QList</span><span class="o">&lt;</span><span class="n">QString</span><span class="o">&gt;::~</span><span class="n">QList</span><span class="p">(</span><span class="n">v32</span><span class="p">);</span>
    <span class="n">QByteArray</span><span class="o">::~</span><span class="n">QByteArray</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v31</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span>                                          <span class="c1">// if ( *(*v32 + 12LL) - *(*v32 + 8LL) &gt; 2 )
</span><span class="c1"></span>  <span class="p">{</span>
    <span class="n">v7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">QFile</span><span class="o">::~</span><span class="n">QFile</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v36</span><span class="p">);</span>
  <span class="n">QFileInfo</span><span class="o">::~</span><span class="n">QFileInfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v30</span><span class="p">);</span>
  <span class="n">QFileInfo</span><span class="o">::~</span><span class="n">QFileInfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v29</span><span class="p">);</span>
  <span class="n">v8</span> <span class="o">=</span> <span class="n">local_hostname</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">local_hostname</span> <span class="o">||</span> <span class="o">*</span><span class="n">local_hostname</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v9</span> <span class="o">=</span> <span class="n">_InterlockedSub</span><span class="p">(</span><span class="n">local_hostname</span><span class="p">,</span> <span class="mi">1u</span><span class="p">),</span> <span class="n">v8</span> <span class="o">=</span> <span class="n">local_hostname</span><span class="p">,</span> <span class="o">!</span><span class="n">v9</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">QArrayData</span><span class="o">::</span><span class="n">deallocate</span><span class="p">(</span><span class="n">v8</span><span class="p">,</span> <span class="mi">2LL</span><span class="p">,</span> <span class="mi">8LL</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">v7</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-c++" data-lang="c++"><span class="kr">__int64</span> <span class="nf">getLogonTimeString</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// ...
</span><span class="c1"></span>
  <span class="n">v75</span> <span class="o">=</span> <span class="n">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
  <span class="n">v54</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v56</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">__cxx11</span><span class="o">::</span><span class="n">basic_string</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">char_traits</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">allocator</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;::</span><span class="n">_M_construct</span><span class="o">&lt;</span><span class="kt">char</span> <span class="k">const</span><span class="o">*&gt;</span><span class="p">(</span>
    <span class="o">&amp;</span><span class="n">v54</span><span class="p">,</span>
    <span class="s">&#34;whoami&#34;</span><span class="p">);</span>
  <span class="n">GetStdoutFromCommand</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v46</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v54</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v54</span> <span class="o">!=</span> <span class="o">&amp;</span><span class="n">v56</span> <span class="p">)</span>
    <span class="k">operator</span> <span class="k">delete</span><span class="p">(</span><span class="n">v54</span><span class="p">);</span>
  <span class="n">v55</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span>
  <span class="n">LOBYTE</span><span class="p">(</span><span class="n">v56</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">v54</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">v56</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">__cxx11</span><span class="o">::</span><span class="n">basic_string</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">char_traits</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">allocator</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;::</span><span class="n">reserve</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v54</span><span class="p">,</span> <span class="n">v47</span> <span class="o">+</span> <span class="mi">14</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="mh">0x7FFFFFFFFFFFFFFFLL</span> <span class="o">-</span> <span class="n">v55</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0xD</span> <span class="p">)</span>
    <span class="n">std</span><span class="o">::</span><span class="n">__throw_length_error</span><span class="p">(</span><span class="s">&#34;basic_string::append&#34;</span><span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">__cxx11</span><span class="o">::</span><span class="n">basic_string</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">char_traits</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">allocator</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;::</span><span class="n">_M_append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v54</span><span class="p">,</span> <span class="s">&#34;last -1 -R -F &#34;</span><span class="p">,</span> <span class="mi">14LL</span><span class="p">);</span>
  <span class="n">std</span><span class="o">::</span><span class="n">__cxx11</span><span class="o">::</span><span class="n">basic_string</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">char_traits</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="p">,</span><span class="n">std</span><span class="o">::</span><span class="n">allocator</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;&gt;::</span><span class="n">_M_append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v54</span><span class="p">,</span> <span class="n">v46</span><span class="p">,</span> <span class="n">v47</span><span class="p">);</span>
  <span class="n">GetStdoutFromCommand</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v49</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v54</span><span class="p">);</span>
  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// ...
</span><span class="c1"></span>    <span class="n">v45</span> <span class="o">=</span> <span class="n">QString</span><span class="o">::</span><span class="n">fromAscii_helper</span><span class="p">(</span><span class="s">&#34;^.*</span><span class="se">\\</span><span class="s">s[0-9][0-9]:[0-9][0-9]:[0-9][0-9]</span><span class="se">\\</span><span class="s">s.*$&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">qword_28</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">v14</span><span class="p">);</span>
    <span class="n">QRegExp</span><span class="o">::</span><span class="n">QRegExp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v44</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v45</span><span class="p">,</span> <span class="mi">1LL</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
    <span class="n">v5</span> <span class="o">=</span> <span class="n">v45</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// ...
</span><span class="c1"></span><span class="p">}</span>
</code></pre></div><p>It works!</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">foobar~foobar~foobar~foobar~1615148676
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">60 * 60 * 24 * 30 * 3 = 7,776,000 ~ 1615148676 - (1606495110527 / 1000)
</code></pre></div><h2 id="100">100%</h2>
<p>TODO</p>
<pre><code class="language-x86asm" data-lang="x86asm">.text:0000000000DFF5C0 ; Activity::CTreeNode::setCheck(bool)
.text:0000000000DFF5C0                 public _ZN8Activity9CTreeNode8setCheckEb
.text:0000000000DFF5C0 _ZN8Activity9CTreeNode8setCheckEb:      ; CODE XREF: Activity::CShapeTest::checkComparatorTree(Activity::CTreeNode *,Activity::CComparable *)+2907↑p
.text:0000000000DFF5C0                                         ; Activity::CShapeTest::checkComparatorTree(Activity::CTreeNode *,Activity::CComparable *)+2AFA↑p ...
.text:0000000000DFF5C0 ; __unwind {
.text:0000000000DFF5C0                 mov     esi, 2
.text:0000000000DFF5C5                 jmp     near ptr _ZN8Activity9CTreeNode12setCheckTypeENS_10ECheckTypeE+1 ; Activity::CTreeNode::setCheckType(Activity::ECheckType)
.text:0000000000DFF5C5 ; ---------------------------------------------------------------------------
.text:0000000000DFF5CA                 db 0FFh
.text:0000000000DFF5CB                 db 0FFh
.text:0000000000DFF5CC                 db  0Fh
.text:0000000000DFF5CD                 db  1Fh
.text:0000000000DFF5CE                 db  40h ; @
.text:0000000000DFF5CF                 db    0
.text:0000000000DFF5D0 ; ---------------------------------------------------------------------------
.text:0000000000DFF5D0                 mov     esi, 2
.text:0000000000DFF5D5                 jmp     _ZN8Activity9CTreeNode12setCheckTypeENS_10ECheckTypeE ; Activity::CTreeNode::setCheckType(Activity::ECheckType)
.text:0000000000DFF5D5 ; } // starts at DFF5C0
.text:0000000000DFF5DA ; ---------------------------------------------------------------------------
.text:0000000000DFF5DA                 nop     word ptr [rax+rax+00h]
.text:0000000000DFF5E0
</code></pre>
    </section>
  </article>
</main>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script type="application/javascript">(function() {
     var $window = $(window);
     if ($window.width() >= 1400) { 
         var $toc = $('#TableOfContents');
         if ($toc.length > 0) {
             function onScroll(){
                 var currentScroll = $window.scrollTop();
                 var h = $('.content h1, .content h2, .content h3, .content h4, .content h5, .content h6, .h-feed h2');
                 var id = "";
                 h.each(function (i, e) {
                     e = $(e);
                     if (e.offset().top - 10 <= currentScroll) {
                         id = e.attr('id');
                     }
                 });
                 var current = $toc.find('a.current');
                 if (current.length == 1 && current.eq(0).attr('href') == '#' + id) return true;

                 current.each(function (i, e) {
                     $(e).removeClass('current').siblings('ul').hide();
                 });
                 $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
                     $(e).children('a').addClass('current').siblings('ul').show();
                 });
             }
             $window.on('scroll', onScroll);
             $(document).ready(function() {
                 $toc.find('a').parent('li').find('ul').hide();
                 onScroll();
                 document.getElementsByClassName('hugotoc')[0].style.display = '';
             });}}})();</script>








<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-172736282-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</div>
    </body>
</html>
